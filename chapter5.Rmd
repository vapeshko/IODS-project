# Dimensionality reduction techniques

## Principal Component Analysis

### Overview of the data

Note where medians are higher than the means
```{r}
library(tidyr)
library(dplyr)
library(ggplot2)
library(GGally)
library(corrplot)


# reading the data

human <- read.table("http://s3.amazonaws.com/assets.datacamp.com/production/course_2218/datasets/human2.txt", sep = ",", header = TRUE)

str(human)

# summaries of variables
summary(human)

# visual summary
gather(human) %>% ggplot(aes(x = key,y = value)) + facet_wrap("key", scales = "free") + geom_boxplot() + labs(x = NULL, y = NULL)

# correlation plots
ggpairs(human)
cor(human) %>% corrplot(type = "upper")

```

### PCA on not-standardized data set

```{r}
# display variance
human %>% summarise_all(var)

# running pca
pca_human <- prcomp(human)

# calculating percentages of variance
s <- summary(pca_human)
pca_pr <- round(100*s$importance[2, ], digits = 1)

# drawing a biplot
## creating labels
pc_lab <- paste0(names(pca_pr), " (", pca_pr, "%)")

## biplot
biplot(pca_human, choices = 1:2, cex = c(0.4, 0.8), xlab = pc_lab[1], ylab = pc_lab[2])

```

### PCA on standardized data set

```{r}
# scaling the data set
human_std <- scale(human) %>% as.data.frame()

# scaled variance
human_std %>% summarise_all(var)

# running pca
pca_human_std <- prcomp(human_std)
pca_human_std

# calculating percentages of variance
s2 <- summary(pca_human_std)
pcapr <- round(100*s2$importance[2, ], digits = 1)

# drawing a biplot
## creating labels
pc_lab2 <- paste0(names(pcapr), " (", pcapr, "%)")


## biplot
biplot(pca_human_std, choices = 1:2, cex = c(0.4, 0.6), xlab = pc_lab2[1], ylab = pc_lab2[2])

```

### Interpretation

PCA on not-standardized data shows that GNI as a variable with the highest variance is enough to predict the overall variance of the data set.

When the data set is scaled, the variance of each variable is 1, and we can see that principal components has become more multifaceted. The second biplot demonstrates that:

* PC1 of a country is pulled to positive values by adolescent birth rate and maternal mortality ratio. It is pulled to negative values by GNI, life expectancy at birth, expectancy of education and secondary education ratio between women and men.

* PC2 of a country is pulled to positive values by women's labour force participation rate and proportion of women in parliament.

Overall, PC1 could be regarded as women's quality of life index, PC2 - as women's societal integration index.

## Multipal Correspondence Analysis

### Data

```{r}
# reading the data
library(FactoMineR)
data("tea")

# overview
str(tea)
summary(tea)

gather(tea[1:18]) %>% ggplot(aes(value)) + facet_wrap("key", scales = "free") + geom_bar() + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 6))+ labs(x = NULL, y = NULL)

gather(tea[19:36]) %>% ggplot(aes(value)) + facet_wrap("key", scales = "free") + geom_bar() + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 6))+ labs(x = NULL, y = NULL)

```

### MCA

```{r}
# selecting columns
keep_columns <- c("Tea", "How", "how", "sugar", "where", "lunch", "breakfast", "dinner", "home")

tea_time <- select(tea, one_of(keep_columns))

# multiple correspondence analysis
mca <- MCA(tea_time, graph = FALSE)

# summary of the model
summary(mca)

# visualize MCA
plot(mca, invisible=c("ind"), habillage = "quali", graph.type = "classic")
```

